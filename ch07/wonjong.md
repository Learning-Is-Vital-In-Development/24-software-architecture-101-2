---
marp: true
---

# Ch07. 아키텍처 특성 범위

---

## 7.1 커플링과 커네이선스

커네이선스 : 두 컴포넌트 중 한쪽이 변경될 경우 다른 쪽도 변경해야 전체 시스템의 정합성이 맞는다면 이들은 커네이선스를 가지고 있는 것

- 정적 커네이선스 : 정적 코드 분석으로 발견
    - e.g. MSA의 두 서비스가 address라는 동일한 클래스를 공유한다면 두 서비스는 서로 정적인 커네이선스를 가지고 있다
    - address라는 공유 클래스를 변경하면 두 서비스 모두 변경해야 한다.
- 동적 커네이선스 : 런타임 동작에 관한 동적 커네이선스
    - 동기, 비동기 두 가지 방식 존재
    - 분산 서비스끼리 동기 호출 -> 호출부는 피호출부의 응답을 기다려야 함
    - 이벤트기반 아키텍처의 비동기 호출은 파이어 앤 포겟(Fire and Forget) 방식이므로 개별적 동작 가능

---

## 7.2 아키텍처 퀀텀과 세분도

소프트웨어는 컴포넌트 레벨의 커플링 뿐만 아니라,
많은 비즈니스 개념이 의미상 여러 시스템 파트를 한데 엮어 기능적으로 응집되어 있다.

퀀텀 : 물리학 용어로, 상호작용을 하는 모든 물리 입자 가운데 가장 작은 양

아키텍처 퀀텀 : 높은 기능 응집도와 동기적 커네이선스를 가진, 독립적으로 배포 가능한 아티팩트


---

1. 독립적으로 배포 가능
- 아키텍처 퀀텀은 아키텍처의 다른 파트와 독립적으로 작동되는 모든 필수 컴포넌트를 포함
- e.g. 단일 DB를 사용하여 배포된 거의 모든 레거시는 아키텍처 퀀텀이 1, MSA는 서비스마다 DB가 따로 존재하므로 퀀텀이 여러개
2. 높은 기능 응집도
- 응집도 : 컴포넌트 설계에 따라 구현된 코드가 얼마나 목적에 맞게 통합되어 있는지를 나타냄
- e.g. Customer 컴포넌트는 고객 엔티티와 관련된 모든 프로퍼티와 메서드를 갖고 있으므로 응집도가 높지만, Utility 컴포넌트는 여러 잡다한 메서드를 무작위로 섞어 놓았기에 응집도가 낮다.
3. 동기적 커네이선스
- 동기적 커네이선스는 아키텍처 퀀텀을 형성하는 애플리케이션 콘텍스트 내부 또는 분산 서비스 간의 동기 호출을 의미
- e.g. MSA에서 어떤 서비스가 다른 서비스를 동기 호출할 때, 운영 아키텍처 측면에서 두 서비스는 두드러진 차이를 나타낼 수 없다.

---

예시

Payment 서비스, Auction 서비스가 있는 MSA

- Auction 서비스는 경매가 끝나면, Payment 서비스로 결제 정보 전달
- Payment 서비스는 매 500ms마다 하나의 결제 정보만 처리

 갑자기 많은 경매가 동시에 종료된다면?

- 첫 번째 호출 통과, 나머지 호출 전부 타임아웃
- 해결 방법 : Payment, Auction 간 비동기 통신 링크를 만들고 메시지 큐가 일시적 버퍼 역할을 수행하도록 설계 -> 비동기적 커네이선스
